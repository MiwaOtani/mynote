<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>暗記アプリMyNote</title>
    <!-- CSS -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- fontawesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>

<body>
    <div class="outerWrapper">

        <!-- ヘッダーをインクルード -->
        <header id="header" class="">
            <nav>
                <ul>
                    <li><a class="nav" th:href="@{/mynote}"><i class="fa-solid fa-house-chimney"></i></a></li>
                    <li><a class="nav" th:href="@{/mynote/admin}"><i class="fa-solid fa-gear"></i></a></li>
            </nav>
            <h1>myNote<i class="fa-solid fa-pencil"></i></h1>
        </header>

        <main id="main" class="">
            <!-- ここにメインコンテンツ -->
			<h2>勉強した履歴のページ</h2>
			<!--Flashメッセージの表示-->
			<p th:if="${message}" th:text="${message}" style="color: blue;">完了メッセージ</p>
			<p th:if="${errorMessage}" th:text="${errorMessage}" style="color: red;">エラーメッセージ</p>
			
			<p>正答率：<span th:text="${correctRate}">70</span>%</p>
<br>
			<p>＜正誤表パターン＞</p>
			<table>
			  <tr>
			    <th>問題一覧</th>
			    <th>正誤</th>
				<th>表示</th>
				<th>切替</th>
			  </tr>
			  
			  <tr th:each="quiz : ${quizzes}">
			    <td th:text="${quiz.question}">問題文</td>
				<td>
				  <span th:if="${quiz.history != null and quiz.history.answeredAt != null}"
				        th:text="${quiz.history.isCorrect ? '○' : '×'}">○</span>
				  <span th:if="${quiz.history == null or quiz.history.answeredAt == null}">未回答</span>
				</td>
				<td th:text="${quiz.isVisible} ? '表示中' : '非表示'"></td>
				<td>
					<form th:action="@{'/mynote/quizzes/' + (${quiz.isVisible} ? 'hide' : 'show') + '/' + ${quiz.id}}" method="post">
						<input type="hidden" name="redirectTo" th:value="@{/mynote/history}" /> <!-- redirectToを変える -->
						<button type="submit" th:text="${quiz.isVisible} ? '非表示にする' : '表示に戻す'"></button>
					</form>
				</td>
			</tr>
			</table>
			
			<p>＜未回答を外して集計＞</p>
			<p>正答率：<span th:text="${correctRate}">70</span>%</p>

			<div th:each="quiz : ${quizzes}">
			  <div th:if="${quiz.history != null and quiz.history.answeredAt != null}">
			    <p th:text="${quiz.question}">問題文</p>
			    <p th:text="${quiz.history.isCorrect ? '○' : '×'}">○<span th:if="${quiz.history == null}">未回答</span></p>
			  </div>
			</div>
			
			
			<h3>全体の正解率</h3>
			<p><span th:text="${correctRate}">70</span>%</p>

			<h3>カテゴリ別正解率</h3>
			<!-- カテゴリ別の集計があればここに -->

			<h3>今日のひとこと</h3>
			<p th:text="${dailyMessage}">猫と暮らす</p>
			
            <!-- //メインコンテンツここまで -->
        </main>

        <!-- フッターをインクルード -->
        <footer id="footer">
            <p>Copyright &copy; 2025 Anki Appli myNote.</p>
        </footer>
    </div><!--outerWrapper-->
	
	<script src="/js/script.js"></script>
</body>

</html>