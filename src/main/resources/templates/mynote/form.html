<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>暗記アプリMyNote</title>
    <!-- CSS -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- fontawesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>

<body>
    <div class="outerWrapper">

        <!-- ヘッダーをインクルード -->
        <header id="header" class="">
            <nav>
                <ul>
                    <li><a class="nav" th:href="@{/mynote}"><i class="fa-solid fa-house-chimney"></i></a></li>
                    <li><a class="nav" th:href="@{/mynote/admin}"><i class="fa-solid fa-gear"></i></a></li>
            </nav>
            <h1>myNote<i class="fa-solid fa-pencil"></i></h1>
        </header>

        <main id="main" class="">
            <!-- ここにメインコンテンツ -->
<!-- タイトル：登録 OR 編集 -->
<h2 th:if="${myNoteForm.isNew}">新しい問題を作成する</h2>
<h2 th:unless="${myNoteForm.isNew}">登録した問題を編集する</h2>
<!-- アクション：登録 OR 編集 -->
<form th:action="${myNoteForm.isNew} ? @{/mynote/quizzes/save} : @{/mynote/quizzes/update}" th:object="${myNoteForm}" method="post" enctype="multipart/form-data">
<!-- idは更新時に必要なため、hiddenで持つ-->
<input type="hidden" th:field="*{id}">

	<h3>問題文を入力する</h3>
    <textarea row="5" cols="30"  th:field="*{question}"></textarea>
	<!--バリデーションエラー表示 -->
	<span th:if="${#fields.hasErrors('question')}" th:errors="*{question}" style="color:red;">エラーがあれば表示</span>
    <label>画像</label><br>
	 <input type="file" name="image" accept="image/*" id="imageInput"><br>
	 <div id="paste_zone">ここに表示されます<br>
	<img id="preview" style="max-width:300px; display:none;"><br></div>


<label>問題形式：</label><br>

  <label>
    <input type="radio" th:field="*{questionType}" name="questionType" value="multiple" />
    選択肢形式
  </label>
  <label>
    <input type="radio" th:field="*{questionType}" name="questionType" value="truefalse" />
    ○×形式
  </label>
  
  
  <div class="answer-row" id="answer1Block">
    <label class="answer-label" data-index="1" for="answer1"></label>
    <textarea id="answer1" th:field="*{answer1}"></textarea>
    <label>
      <input type="radio" name="correctAns" value="1" th:checked="${myNoteForm.correctAns == 1}" />
      正解
    </label>
	<!--バリデーションエラー表示 -->
	<span th:if="${#fields.hasErrors('answer1')}" th:errors="*{answer1}" style="color:red;">エラーがあれば表示</span>
  </div>

  <div class="answer-row" id="answer2Block" >
    <label class="answer-label" data-index="2" for="answer2"></label>
    <textarea id="answer2" th:field="*{answer2}"></textarea>
    <label>
      <input type="radio" name="correctAns" value="2" th:checked="${myNoteForm.correctAns == 2}" />
      正解
    </label>
	<!--バリデーションエラー表示 -->
	<span th:if="${#fields.hasErrors('answer2')}" th:errors="*{answer2}" style="color:red;">エラーがあれば表示</span>
  </div>

  <!-- answer3・answer4は表示制御あり -->
  <div class="answer-row" id="answer3Block" style="display:none;">
    <label class="answer-label" data-index="3" for="answer3"></label>
    <textarea id="answer3" th:field="*{answer3}"></textarea>
    <label>
      <input type="radio" name="correctAns" value="3" th:checked="${myNoteForm.correctAns == 3}" />
      正解
    </label>
  </div>

  <div class="answer-row" id="answer4Block" style="display:none;">
    <label class="answer-label" data-index="4" for="answer4"></label>
    <textarea id="answer4" th:field="*{answer4}"></textarea>
    <label>
      <input type="radio" name="correctAns" value="4" th:checked="${myNoteForm.correctAns == 4}" />
      正解
    </label>
  </div>
  
  
<!-- ボタン：登録 OR 編集 -->
<input th:if="${myNoteForm.isNew}" type="submit" value="登録する">
<input th:unless="${myNoteForm.isNew}" type="submit" value="更新する">
</form>
<a th:href="@{/mynote}">トップページへ戻る</a>

            <!-- //メインコンテンツここまで -->
        </main>

        <!-- フッターをインクルード -->
        <footer id="footer">
            <p>Copyright &copy; 2025 Anki Appli myNote.</p>
        </footer>
    </div><!--outerWrapper-->

	<script src="/js/script.js"></script>
</body>

</html>